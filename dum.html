<head>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>



<body>
    <!-- <audio id="a1" controls autoplay></audio>
    <audio id="a2" controls autoplay></audio> -->
    <video id="remote" autoplay controls muted class="has-ratio" width="640" frameborder="2" allowfullscreen
        style="background-color: #8A2BE2;">
    </video>
    <script>
        //@ts-check


        var localVideo = document.querySelector('#local'),
            remoteVideo = document.querySelector('#remote'),
            localConnection, remoteConnection;

        navigator.getUserMedia({ video: true, audio: false }, function (stream) {
            //localVideo.srcObject = stream;
            startPeerConnection(stream);
        }, function (error) {
            alert("Camera capture failed!")
        });


        function startPeerConnection(stream) {

            localConnection = new RTCPeerConnection({ iceServers: [] })
            localConnection.ontrack = function (e) { console.log(888) }
            remoteConnection = new RTCPeerConnection({})
            stream.getTracks().forEach(
                function (track) {
                    localConnection.addTrack(
                        track,
                        stream
                    );
                }
            )
            stream.getTracks().forEach(
                function (track) {
                    remoteConnection.addTrack(
                        track,
                        stream
                    );
                }
            )

            remoteConnection.ontrack = function (e) {
                // remoteVideo.srcObject = e.streams[0];
                const xvid = /** @type {HTMLVideoElement} */ (document.getElementById('remote'))
                xvid.srcObject = e.streams[0];
                console.log(999)
            };




            // Set up the ICE candidates for the two peers

            localConnection.onicecandidate = e => !e.candidate
                || remoteConnection.addIceCandidate(e.candidate)
                    .catch(e => {
                        console.error(e)
                    });

            remoteConnection.onicecandidate = e => !e.candidate
                || localConnection.addIceCandidate(e.candidate)
                    .catch(e => {
                        console.error(e)
                    });

            localConnection.createOffer()
                .then(offer => localConnection.setLocalDescription(offer))
                .then(() => remoteConnection.setRemoteDescription(localConnection.localDescription))
                .then(() => remoteConnection.createAnswer())
                .then(answer => remoteConnection.setLocalDescription(answer))
                .then(() => localConnection.setRemoteDescription(remoteConnection.localDescription))
                .catch(e => {
                    console.error(e)
                });
        }




    </script>
</body>